<!DOCTYPE html>
<html>
<head>
	<title>Assignment 06: Registration Form Validation</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
	<style>
		body{
			width: 800px;
			margin-left: auto;
			margin-right: auto;
		}
		h1{
			margin:30px;
		}
		p{
			font-size:10px;
			float:right;
		}
		.clearfloat{
			clear:both;
		}
		.star{
			color:red;
			font-size:5px;
		}
		.data{
			float:left;
			width:200px;
			margin-top:20px;
		}
		.output{
			float:left;
			margin-top:20px;
		}
	</style>
</head>
<body>
	<h1>Registration Form</h1>
	<form id="registration">
		<div class="form-group row">
			<label for="firstname" class="col-sm-2 col-form-label">First name:</label>
			<div class="col-sm-10">
				<input type="text" name="firstname" class="form-control" placeholder="Tommy" id="firstname">
				<small id="firstname-error" class="form-text text-danger"></small>
			</div>
		</div>
		<div class="form-group row">
			<label for="lastname" class="col-sm-2 col-form-label">Last name:</label>
			<div class="col-sm-10">
				<input type="text" name="lastname" class="form-control" placeholder="Trojan" id="lastname">
				<small id="lastname-error" class="form-text text-danger"></small>
			</div>
		</div>
		<div class="form-group row">
			<label for="email" class="col-sm-2 col-form-label">Email:</label>
			<div class="col-sm-10">
				<input type="text" name="email" class="form-control" placeholder="ttrojan@usc.edu" id="email">
				<small id="email-error" class="form-text text-danger"></small>
			</div>
		</div> 
		<div class="form-group row">
			<label for="website" class="col-sm-2 col-form-label">Website:</label>
			<div class="col-sm-10">
				<input type="text" name="website" class="form-control" placeholder="https://usc.edu" id="website">
				<small id="website-error" class="form-text text-danger"></small>
			</div>
		</div>
		<div class="form-group row">
			<label for="phone" class="col-sm-2 col-form-label">Phone:</label>
			<div class="col-sm-10">
				<input type="text" name="phone" class="form-control" placeholder="123-123-1234" id="phone">
				<small id="phone-error" class="form-text text-danger"></small>
			</div>
		</div>
		<div class="form-group row">
			<label for="password" class="col-sm-2 col-form-label">Password:</label>
			<div class="col-sm-10">
				<input type="text" name="password" class="form-control" id="password">
				<small id="password-error" class="form-text text-danger"></small>
			</div>
		</div>
		<div class="form-group row">
			<div class="col-sm-10">
				<button type="submit" class="btn btn-primary">Submit</button>
			</div> <!-- .col -->
		</div> <!-- .form-group -->
	</form>

	<h1>Data Output</h1>
	<div class="data">Full Name:</div>
	<div class="output"></div>
	<div class="clearfloat"></div>
	<div class="data">Email Perfix:</div>
	<div class="output"></div>
	<div class="clearfloat"></div>
	<div class="data">Formatted Phone Number:</div>
	<div class="output"></div>
	<div class="clearfloat"></div>


	<script>
		document.querySelector("#registration").onsubmit = function(){
			var isValid = true;
			var firstname = document.querySelector('#firstname').value;
			var lastname = document.querySelector('#lastname').value;
			var email = document.querySelector('#email').value;
			var website = document.querySelector('#website').value;
			var phone = document.querySelector('#phone').value;
			var password = document.querySelector('#password').value;

			if(/^$/.test(firstname)){
				document.querySelector("#firstname-error").innerHTML = "First name cannot be empty."
				isValid = false;
			}
			else if(/^[A-Z][a-z]{0,}$/.test(firstname)){
				document.querySelector("#firstname-error").innerHTML = "";
				}
			else{
				document.querySelector("#firstname-error").innerHTML = "Invalid First Name.";
				isValid = false;
			}

			if(/^$/.test(lastname)){
				document.querySelector("#lastname-error").innerHTML = "Last name cannot be empty."
				isValid = false;
			}
			else if(/^[A-Z][a-z]{0,}$/.test(lastname)){
				document.querySelector("#lastname-error").innerHTML = "";
			}
			else{
				document.querySelector("#lastname-error").innerHTML = "Invalid Last Name.";
				isValid = false;
			}

			var emailRegEx = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

			if(/^$/.test(email)){
				document.querySelector("#email-error").innerHTML = "Email cannot be empty."
				isValid = false;
			}
			else if(emailRegEx.test(email)){
				if (/(usc.edu)$/.test(email)){
					document.querySelector("#email-error").innerHTML = "";
				}
				else{
					document.querySelector("#email-error").innerHTML = "Must be usc.edu email.";
					isValid = false;
				}
			}
			else{
				document.querySelector("#email-error").innerHTML = "Invalid email";
				isValid = false;
			}

			var urlRegEx = /^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;
			if(/^$/.test(website)){
				document.querySelector('#website-error').innerHTML = "Website cannot be empty.";
				isValid = false;
			}
			else if(urlRegEx.test(website)){
				document.querySelector('#website-error').innerHTML = "";
			}
			else{
				if (/^(http:\/\/|https:\/\/)/.test(website)){
					document.querySelector('#website-error').innerHTML = "Invalid URL.";
					isValid = false;
				}
				else{
					document.querySelector('#website-error').innerHTML = "Must start with http:// or https://.";
					isValid = false;
				}
			}

			if (/^$/.test(phone)){
				document.querySelector('#phone-error').innerHTML = "Phone cannot be empty.";
				isValid = false;
			}
			else if(/^\d{3}[\s|\-]\d{3}[\s|\-]\d{4}$/.test(phone)){
				document.querySelector('#phone-error').innerHTML = "";
			}
			else{
				document.querySelector('#phone-error').innerHTML = "Invalid phone format";
				isValid = false;
			}

			if (/^$/.test(password)){
				document.querySelector('#password-error').innerHTML = "Password cannot be empty.";
				isValid = false;
			}
			else if(/[A-Z]+/.test(password) && /[a-z]+/.test(password) && /\d+/.test(password) && /[\!\@\#\$\%\^\&\*]+/.test(password)){
				document.querySelector('#password-error').innerHTML = "";
			}
			else{
				document.querySelector('#password-error').innerHTML = "Insecure Password.";
				isValid = false;
			}

			if (isValid){
				var emailIndex = email.indexOf('@');
				var numberPhone = phone.replace(/\D/g,"");
				var formattedPhone = numberPhone.substr(0,3) + "-" + numberPhone.substr(3,3) + "-" + numberPhone.substr(6)
				document.querySelectorAll('.output')[0].innerHTML = firstname + " " + lastname;
				document.querySelectorAll('.output')[1].innerHTML = email.substr(0,emailIndex);
				document.querySelectorAll('.output')[2].innerHTML = formattedPhone;
			}
			else{
				document.querySelectorAll('.output')[0].innerHTML = "";
				document.querySelectorAll('.output')[1].innerHTML = "";
				document.querySelectorAll('.output')[2].innerHTML = "";
			}

			return false;
		}
	</script>
</body>
</html>